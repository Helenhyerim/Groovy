<?xml version="1.0" encoding="UTF-8"?>

<!-- ==== #29. mapper 기본설정 ==== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- ==== #29. 루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체내에서 유일해야 한다.) ==== -->
<mapper namespace="leejh">

	<!-- === 로그인 처리하기 === -->
	
	<select id="getLoginEmployee" resultType="com.spring.groovy.model.EmployeeVO" parameterType="HashMap">

		SELECT  pk_empnum, pwd, name,  address,  detailaddress,
			 extraaddress, postcode, phone,  email,  birthday, gender,
			 registerday, startday, resignationstatus,  nvl(resignationday,'2099-12-31'),  fk_vstatus,
			  fk_deptnum,  fk_spotnum,  emppicturename,  salary, lastpwdchangedate
		from tbl_employee
		where pk_empnum = #{pk_empnum} and pwd= #{pwd}
	</select>
	
	<!-- << 로그인 기록 카운트 >> -->
	
	<!-- === 해당하는 이메일과 사원번호에 존재하는 사원 정보 찾기(select) === -->
	<select id="sendCodeEmail" parameterType="HashMap" resultType="String">
		select pk_empnum
		from tbl_employee
		where pk_empnum = #{pk_empnum} and  email = #{email} 
	</select>
	
	<!-- === 새비밀번호 업데이트 메서드(update) === -->
	<update id="newPwdUpdate" parameterType="HashMap">
		update tbl_employee set pwd = #{newPassword}
		where pk_empnum = #{pk_empnum} and  email = #{email} 
	</update>

</mapper>